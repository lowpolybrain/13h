"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t={sin:function(t,e){return Math.sin(t)*e/2+e/2},cos:function(t,e){return Math.cos(t)*e/2+e/2}},e=function(t,e=[0,0]){return null==t?[e[0],e[1]]:"number"==typeof t?[t,t]:[t[0],t[1]]},n=(t,e,n)=>Math.min(Math.max(t,e),n),r={half:[.5,.5],zero:[0,0],one:[1,1],addHalf(t,n=1){const[r,o]=e(n);return[t[0]+r/2,t[1]+o/2]},insideRegion(t,n,r){const[o,s]=e(n),[i,h]=e(r);return t[0]>=o&&t[0]<=i&&t[1]>=s&&t[1]<=h},round:t=>[Math.round(t[0]),Math.round(t[1])],floor:t=>[Math.floor(t[0]),Math.floor(t[1])],ceil:t=>[Math.ceil(t[0]),Math.ceil(t[1])],add(...t){let e=0,n=0;for(let o=0;o<t.length;o++){const[s,i]=r.get(t[o]);e+=s,n+=i}return[e,n]},dist(t,e=[0,0]){const n=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(n*n+r*r)},neg:([t,e])=>[-t,-e],mul(...t){let n=1,r=1;for(let o=0;o<t.length;o++){const[s,i]=e(t[o]);n*=s,r*=i}return[n,r]},div([t,n],r){const[o,s]=e(r);return[t/o,n/s]},sub([t,n],r){const[o,s]=e(r);return[t-o,n-s]},get:e,scale([t,n],r,o){const[s,i]=e(r),[h,a]=e(o);return[(t-h)*s+a,(n-a)*i+a]},mod([t,n],r){const[o,s]=e(r);return[t%o,n%s]},rotate([t,n],r,o){const[s,i]=e(o||[0,0]),h=Math.sin(r),a=Math.cos(r);return[h*(t-s)+a*(n-i)+s,h*(n-i)-a*(t-s)+i]},sizeToScale(t,e){const n=r.get(t);if(0===n[0]||0===n[1])return[0,0];const o=r.get(e);return[o[0]/n[0],o[1]/n[1]]},clamp:([t,e],[r,o],[s,i])=>[n(t,r,s),n(e,o,i)],eq(...t){if(1===t.length)return!0;const n=e(t[0]);for(let r=1;r<t.length;r++){const o=e(t[r]);if(o[0]!==n[0]||o[1]!==n[1])return!1}return!0}},o=2*Math.PI,s=Math.PI/180,i=180/Math.PI,h=Math.PI/2,a=Math.sqrt(2),l={black:"#000000",blue:"#00A",green:"#0A0",cyan:"#0A0",red:"#A00",magenta:"#A0A",brown:"#A50",lightGray:"#AAA",darkGray:"#555",lightBlue:"#55f",lightGreen:"#5f5",lightCyan:"#5F5",lightRed:"#F55",lightMagenta:"#F5F",yellow:"#FF5",white:"#FFF"},c={hueBetween(t,e,n=360){const r=(t>n?t%n:t)/n,o=(e>n?e%n:e)/n,[s,i]=r<o?[r,o]:[o,r];return(s+i)/2*n},hsl:(t=0,e=100,n=50,r=1)=>r<1?`hsla(${t}, ${e}%, ${n}%, ${r})`:`hsl(${t}, ${e}%, ${n}%)`,hslRot:t=>c.hsl(Math.round(t*i)),rgb:(t=0,e=t,n=t,r=1)=>r<1?`rgba(${t},${e},${n}, ${r})`:`rgba(${t},${e},${n})`,...l},p=function(t,e,n){const o=r.get(n),s=[];for(let n=0;n<t.length;n++)s.push(r.rotate(t[n],e,o));return s},u=function(t,e){const n=r.get(e),o=[];for(let e=0;e<t.length;e++)o.push(r.scale(t[e],n));return o},x=function(t,e){const n=r.get(e),o=[];for(let e=0;e<t.length;e++){const r=t[e];o.push([r[0]+n[0],r[1]+n[1]])}return o};class g{shape;constructor(t){this.shape=t}rotate(t,e){return new g(p(this.shape,t,e))}scale(t){return new g(u(this.shape,t))}translate(t){return new g(x(this.shape,t))}}const d=function(t){return new g(t)},f={rect([t,e]=[0,0],[n,r]=[0,0],o=!0){const s=o?0:.5;return[[t+s,e+s],[n-s,e+s],[n-s,r-s],[t+s,r-s]]},ngon(t=3){const e=[],n=o/t;for(let r=0;r<t;r+=1)e.push([Math.sin(r*n),Math.cos(r*n)]);return e}},m={ngon:(t=3)=>d(f.ngon(t)),rect:(t,e,n=!0)=>d(f.rect(t,e,n))};d.make=f,d.build=m,d.scale=u,d.translate=x,d.rotate=p;const w={range:(t,e)=>Math.random()*(e-t)+t,iRange:(t,e)=>Math.round(w.range(t,e)),m32(t){let e=t+1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296},m32p:(t,e=t+16e3)=>[w.m32(t),w.m32(e)]};var _,R,C,M;exports.Corner=void 0,(_=exports.Corner||(exports.Corner={})).TopLeft="topLeft",_.TopRight="topRight",_.BottomRight="bottomRight",_.BottomLeft="bottomLeft",exports.BoxPoint=void 0,(R=exports.BoxPoint||(exports.BoxPoint={})).Center="center",R.TopLeft="topLeft",R.TopRight="topRight",R.BottomRight="bottomRight",R.BottomLeft="bottomLeft",exports.LineCap=void 0,(C=exports.LineCap||(exports.LineCap={})).Butt="butt",C.Round="round",C.Square="square",exports.Repeat=void 0,(M=exports.Repeat||(exports.Repeat={})).XY="repeat",M.X="repeat-x",M.Y="repeat-y",M.None="no-repeat";class A{strokeFill(t,e,n,r){r&&this.context.closePath(),e&&(this.context.lineWidth=e),t&&(this.context.fillStyle=t),n&&(this.context.strokeStyle=n),(e||n)&&this.context.stroke(),t&&this.context.fill()}element;context;_size=[0,0];_maxPoint=[0,0];_center=[0,0];_pivot=[0,0];get pivot(){return this._pivot}get size(){return this._size}get maxPoint(){return this._maxPoint}get height(){return this._size[1]}get width(){return this._size[0]}get cx(){return this._size[0]/2}get cy(){return this._size[1]/2}get center(){return this._center}getCorners(t=!1){const e=t?.5:1;return{[exports.Corner.TopLeft]:[e,e],[exports.Corner.TopRight]:[this.width-e,e],[exports.Corner.BottomRight]:[this.width-e,this.height-e],[exports.Corner.BottomLeft]:[e,this.height-e]}}getContour(t=!1){return Object.values(this.getCorners(t))}constructor(t,e){const[n,o]=r.get(t);this.element=document.createElement("canvas");const s=this.element.getContext("2d");if(!s)throw new Error("Could not retrieve canvas context. Are you on web?");this.context=s,this.setSize([n,o]),e&&this.appendTo(e)}appendTo(t){return t.appendChild(this.element),this}setSize([t,e]){return this._size=[t,e],this._maxPoint=[t?t-1:0,e?e-1:0],this._center=[t/2,e/2],this.element.width=t,this.element.height=e,this}setPivot([t,e]){return this._pivot=[t,e],this}centerPivot(){return this.setPivot(this._center)}rect([t,e],[n,r],o){if(this.setFillStyle(o),t!==n&&e!==r){const o=t<n?n-t:t-n,s=e<r?r-e:e-r,i=t<n?t:n,h=e<r?e:r;this.context.fillRect(i,h,o,s)}return this}dot([t,e],n,r=1){n&&(this.context.fillStyle=n);const o=Math.floor(r/2);return this.context.fillRect(t-o,e-o,r,r),this}setFillStyle(t){return t&&(this.context.fillStyle=t),this}fill(t){return this.setFillStyle(t),this.context.fillRect(0,0,this.width,this.height),this}clear(){return this.context.clearRect(0,0,this.width,this.height),this}crisp(){return this.context.imageSmoothingEnabled=!1,this.element.style.imageRendering="pixelated",this}draw(t,[e,n]=[0,0],o,s=1,i=1){const h=r.get(s);t.context.save();const[a,l]=this.pivot;return t.context.globalAlpha=i,o||h||o?((e||n)&&t.context.translate(e,n),o&&t.context.rotate(o),h&&t.context.scale(h[0],h[1]),t.context.translate(-a,-l),t.context.drawImage(this.element,0,0)):t.context.drawImage(this.element,e-a,n-l),t.context.restore(),this}line(t,e,n,o=1){return this.poly([r.get(t),r.get(e)],"transparent",o,n,!1),this}createPattern(t,e=exports.Repeat.XY){let n;return n=t instanceof A?t.element:t,this.context.createPattern(n,e)}poly(t,e,n=1,r,o=!0,s=exports.LineCap.Butt){if(t.length<=1)return this;this.context.lineCap=s,this.context.beginPath(),this.context.moveTo(t[0][0],t[0][1]);for(var i=1;i<t.length;i++)this.context.lineTo(t[i][0],t[i][1]);return this.strokeFill(e,n,r,o),this}copy(t,e){const[n,o]=r.get(t),[s,i]=r.get(e,this.size),h=new A([s-n,i-o]);return h.context.drawImage(this.element,-n,-o),h}get text(){const t=this;let e="start",n="top";const r=function(r,[o,s]=[10,10],i){const h=t.context.textAlign,a=t.context.textBaseline;return t.context.textAlign=e,t.context.textBaseline=n,t.setFillStyle(i),t.context.fillText(`${r}`,o,s),t.context.textAlign=h,t.context.textBaseline=a,t};return Object.defineProperty(r,"center",{get:function(){return e="center",n="middle",r}}),r}}class y{fireOnAdd;happensOnce;timesFired=0;constructor(t=!1,e=!1){this.fireOnAdd=t,this.happensOnce=e}handlers=[];addHandler(t){this.fireOnAdd&&this.timesFired>0&&this.lastArgs&&t.apply(this,this.lastArgs),this.handlers.push(t)}lastArgs;fire(...t){if(!this.happensOnce||0===this.timesFired){this.timesFired+=1,this.lastArgs=t;for(let e=0;e<this.handlers.length;e++)this.handlers[e]?.apply(this,t)}}}exports.CGA=l,exports.Canvas=A,exports.DEG_TO_RAD=s,exports.EventListener=y,exports.PI_BY_TWO=h,exports.RAD_TO_DEG=i,exports.REVISION=2,exports.SQR_TWO=a,exports.TWO_PI=o,exports.animate=function(t,e={}){let n,r=0,o=0;if(e.cleanupId){if(window._cdeCleanup){const t=window._cdeCleanup[e.cleanupId];t&&(console.log("Cancelled",t),window.cancelAnimationFrame(t))}else window._cdeCleanup={};n=t=>{window._cdeCleanup&&e.cleanupId&&(window._cdeCleanup[e.cleanupId]=t)}}const s=n=>{null!=e.frameSkip&&e.frameSkip>0?(o=(o+1)%e.frameSkip,o||t(r++,n)):t(r++,n)};if(null!=e.initialSkip&&e.initialSkip>0)for(let t=0;t<e.initialSkip;t++)s(0);const i=t=>{const e=window.requestAnimationFrame(t);n&&n(e)},h=t=>{if(e.frameRepeat)for(let n=0;n<=e.frameRepeat;n++)s(t);else s(t);i(h)};i(h)},exports.clamp=n,exports.color=c,exports.getColor=function(t,e){const[n,o]=r.get(e);return t.context.getImageData(n,o,1,1).data},exports.makeListener=function(t=!1,e=!1){const n=new y(t,e),r=function(t){n.addHandler(t)};return r.fire=function(...t){n.fire(...t)},r},exports.makeShape=f,exports.osc=t,exports.point=r,exports.random=w,exports.shape=d;

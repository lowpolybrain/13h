"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t={sin:function(t,e){return Math.sin(t)*e/2+e/2},cos:function(t,e){return Math.cos(t)*e/2+e/2}},e=function(t,e=[0,0]){return null==t?[e[0],e[1]]:"number"==typeof t?[t,t]:[t[0],t[1]]},n={round:t=>[Math.round(t[0]),Math.round(t[1])],floor:t=>[Math.round(t[0]),Math.floor(t[1])],ceil:t=>[Math.round(t[0]),Math.ceil(t[1])],add(...t){let e=0,r=0;for(let o=0;o<t.length;o++){const[s,i]=n.get(t[o]);e+=s,r+=i}return[e,r]},dist(t,e=[0,0]){const n=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(n*n+r*r)},neg:([t,e])=>[-t,-e],mul(...t){let n=1,r=1;for(let o=0;o<t.length;o++){const[s,i]=e(t[o]);n*=s,r*=i}return[n,r]},div([t,n],r){const[o,s]=e(r);return[t/o,n/s]},sub([t,n],r){const[o,s]=e(r);return[t-o,n-s]},get:e,scale([t,n],r,o){const[s,i]=e(r),[h,a]=e(o);return[(t-h)*s+a,(n-a)*i+a]},mod([t,n],r){const[o,s]=e(r);return[t%o,n%s]},rotate([t,n],r,o){const[s,i]=e(o||[0,0]),h=Math.sin(r),a=Math.cos(r);return[h*(t-s)+a*(n-i)+s,h*(n-i)-a*(t-s)+i]},sizeToScale(t,e){const r=n.get(t);if(0===r[0]||0===r[1])return[0,0];const o=n.get(e);return[o[0]/r[0],o[1]/r[1]]}},r=2*Math.PI,o=Math.PI/180,s=180/Math.PI,i=Math.PI/2,h=Math.sqrt(2),a={black:"#000000",blue:"#00A",green:"#0A0",cyan:"#0A0",red:"#A00",magenta:"#A0A",brown:"#A50",lightGray:"#AAA",darkGray:"#555",lightBlue:"#55f",lightGreen:"#5f5",lightCyan:"#5F5",lightRed:"#F55",lightMagenta:"#F5F",yellow:"#FF5",white:"#FFF"},l={hueBetween(t,e,n=360){const r=(t>n?t%n:t)/n,o=(e>n?e%n:e)/n,[s,i]=r<o?[r,o]:[o,r];return(s+i)/2*n},hsl:(t=0,e=100,n=50,r=1)=>r<1?`hsla(${t}, ${e}%, ${n}%, ${r})`:`hsl(${t}, ${e}%, ${n}%)`,hslRot:t=>l.hsl(Math.round(t*s)),rgb:(t=0,e=t,n=t,r=1)=>r<1?`rgba(${t},${e},${n}, ${r})`:`rgba(${t},${e},${n})`,...a},c=function(t,e,r){const o=n.get(r),s=[];for(let r=0;r<t.length;r++)s.push(n.rotate(t[r],e,o));return t.map((t=>n.rotate(t,e,o)))},p=function(t,e){const r=n.get(e),o=[];for(let e=0;e<t.length;e++)o.push(n.scale(t[e],r));return o},u=function(t,e){const r=n.get(e),o=[];for(let e=0;e<t.length;e++)o.push([t[e][0]+r[0],t[e][1]+r[1]]);return o};class x{shape;constructor(t){this.shape=t}rotate(t,e){return new x(c(this.shape,t,e))}scale(t){return new x(p(this.shape,t))}translate(t){return new x(u(this.shape,t))}}const d=function(t){return new x(t)},g={rect([t,e]=[0,0],[n,r]=[0,0],o=!0){const s=o?0:.5;return[[t+s,e+s],[n-s,e+s],[n-s,r-s],[t+s,r-s]]},ngon(t=3){const e=[],n=r/t;for(let r=0;r<t;r+=1)e.push([Math.sin(r*n),Math.cos(r*n)]);return e}},f={ngon:(t=3)=>d(g.ngon(t)),rect:(t,e,n=!0)=>d(g.rect(t,e,n))};d.make=g,d.build=f,d.scale=p,d.translate=u,d.rotate=c;const m={range:(t,e)=>Math.random()*(e-t)+t,iRange:(t,e)=>Math.round(m.range(t,e)),m32(t){let e=t+1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296},m32p:(t,e=t+16e3)=>[m.m32(t),m.m32(e)]};var w,C,R,_;exports.Corner=void 0,(w=exports.Corner||(exports.Corner={})).TopLeft="topLeft",w.TopRight="topRight",w.BottomRight="bottomRight",w.BottomLeft="bottomLeft",exports.BoxPoint=void 0,(C=exports.BoxPoint||(exports.BoxPoint={})).Center="center",C.TopLeft="topLeft",C.TopRight="topRight",C.BottomRight="bottomRight",C.BottomLeft="bottomLeft",exports.LineCap=void 0,(R=exports.LineCap||(exports.LineCap={})).Butt="butt",R.Round="round",R.Square="square",exports.Repeat=void 0,(_=exports.Repeat||(exports.Repeat={})).XY="repeat",_.X="repeat-x",_.Y="repeat-y",_.None="no-repeat";class A{strokeFill(t,e,n,r){r&&this.context.closePath(),e&&(this.context.lineWidth=e),t&&(this.context.fillStyle=t),n&&(this.context.strokeStyle=n),(e||n)&&this.context.stroke(),t&&this.context.fill()}element;context;_size=[0,0];_center=[0,0];_pivot=[0,0];get pivot(){return this._pivot}get size(){return this._size}get height(){return this._size[1]}get width(){return this._size[0]}get cx(){return this._size[0]/2}get cy(){return this._size[1]/2}get center(){return this._center}getCorners(t=!1){const e=t?.5:1;return{[exports.Corner.TopLeft]:[e,e],[exports.Corner.TopRight]:[this.width-e,e],[exports.Corner.BottomRight]:[this.width-e,this.height-e],[exports.Corner.BottomLeft]:[e,this.height-e]}}getContour(t=!1){return Object.values(this.getCorners(t))}constructor(t,e){const[r,o]=n.get(t);this.element=document.createElement("canvas");const s=this.element.getContext("2d");if(!s)throw new Error("Could not retrieve canvas context. Are you on web?");this.context=s,this.setSize([r,o]),e&&this.appendTo(e)}appendTo(t){return t.appendChild(this.element),this}setSize([t,e]){return this._size=[t,e],this._center=[t/2,e/2],this.element.width=t,this.element.height=e,this}setPivot([t,e]){return this._pivot=[t,e],this}centerPivot(){return this.setPivot(this._center)}rect([t,e],[n,r],o){if(this.setFillStyle(o),t!==n&&e!==r){const o=t<n?n-t:t-n,s=e<r?r-e:e-r,i=t<n?t:n,h=e<r?e:r;this.context.fillRect(i,h,o,s)}return this}dot([t,e],n,r=1){n&&(this.context.fillStyle=n);const o=Math.floor(r/2);return this.context.fillRect(t-o,e-o,r,r),this}setFillStyle(t){return t&&(this.context.fillStyle=t),this}fill(t){return this.setFillStyle(t),this.context.fillRect(0,0,this.width,this.height),this}clear(){return this.context.clearRect(0,0,this.width,this.height),this}crisp(){return this.context.imageSmoothingEnabled=!1,this.element.style.imageRendering="pixelated",this}draw(t,[e,r]=[0,0],o,s=1,i=1){const h=n.get(s);t.context.save();const[a,l]=this.pivot;return t.context.globalAlpha=i,o||h||o?((e||r)&&t.context.translate(e,r),o&&t.context.rotate(o),h&&t.context.scale(h[0],h[1]),t.context.translate(-a,-l),t.context.drawImage(this.element,0,0)):t.context.drawImage(this.element,e-a,r-l),t.context.restore(),this}line(t,e,r,o=1){return this.poly([n.get(t),n.get(e)],"transparent",o,r,!1),this}createPattern(t,e=exports.Repeat.XY){return t instanceof A?this.context.createPattern(t.element,e):this.context.createPattern(t,e)}poly(t,e,n=1,r,o=!0,s=exports.LineCap.Butt){this.context.lineCap=s,this.context.beginPath(),this.context.moveTo(t[0][0],t[0][1]);for(var i=1;i<t.length;i++)this.context.lineTo(t[i][0],t[i][1]);return this.strokeFill(e,n,r,o),this}copy(t,e){const[r,o]=n.get(t),[s,i]=n.get(e,this.size),h=new A([s-r,i-o]);return h.context.drawImage(this.element,-r,-o),h}get text(){const t=this;let e="start",n="top";const r=function(r,[o,s]=[10,10],i){const h=t.context.textAlign,a=t.context.textBaseline;return t.context.textAlign=e,t.context.textBaseline=n,t.setFillStyle(i),t.context.fillText(`${r}`,o,s),t.context.textAlign=h,t.context.textBaseline=a,t};return Object.defineProperty(r,"center",{get:function(){return e="center",n="middle",r}}),r}}class M{fireOnAdd;happensOnce;timesFired=0;constructor(t=!1,e=!1){this.fireOnAdd=t,this.happensOnce=e}handlers=[];addHandler(t){this.fireOnAdd&&this.timesFired>0&&this.lastArgs&&t.apply(this,this.lastArgs),this.handlers.push(t)}lastArgs;fire(...t){if(!this.happensOnce||0===this.timesFired){this.timesFired+=1,this.lastArgs=t;for(let e=0;e<this.handlers.length;e++)this.handlers[e].apply(this,t)}}}exports.CGA=a,exports.Canvas=A,exports.DEG_TO_RAD=o,exports.EventListener=M,exports.PI_BY_TWO=i,exports.RAD_TO_DEG=s,exports.REVISION=2,exports.SQR_TWO=h,exports.TWO_PI=r,exports.animate=function(t,e={}){let n,r=0,o=0;if(e.cleanupId){if(window._cdeCleanup){const t=window._cdeCleanup[e.cleanupId];t&&(console.log("Cancelled",t),window.cancelAnimationFrame(t))}else window._cdeCleanup={};n=t=>{window._cdeCleanup&&e.cleanupId&&(window._cdeCleanup[e.cleanupId]=t)}}const s=n=>{null!=e.frameSkip&&e.frameSkip>0?(o=(o+1)%e.frameSkip,o||t(r++,n)):t(r++,n)};if(null!=e.initialSkip&&e.initialSkip>0)for(let t=0;t<e.initialSkip;t++)s(0);const i=t=>{const e=window.requestAnimationFrame(t);n&&n(e)},h=t=>{if(e.frameRepeat)for(let n=0;n<=e.frameRepeat;n++)s(t);else s(t);i(h)};i(h)},exports.color=l,exports.getColor=function(t,e){const[r,o]=n.get(e);return t.context.getImageData(r,o,1,1).data},exports.makeListener=function(t=!1,e=!1){const n=new M(t,e),r=function(t){n.addHandler(t)};return r.fire=function(...t){n.fire(...t)},r},exports.makeShape=g,exports.osc=t,exports.point=n,exports.random=m,exports.shape=d;

{"version":3,"file":"index.js","sources":["../../FlyingBounce.ts","../../whiteNoise.ts"],"sourcesContent":["import { point, Point, PointArg, TWO_PI } from '@13h/core';\n\nexport class FlyingBounce<Payload = never> {\n  public position: [number, number];\n  public speed: [number, number];\n  public size: Point;\n  public borderSize: Point;\n  public payload: Payload;\n  public step: number = 0;\n\n  constructor(speed?: PointArg, size: PointArg = 0.01, borderSize: PointArg = 1, startPos?: PointArg) {\n    this.speed = point.get(speed, FlyingBounce.randomDirection(Math.random() * 0.01 + 0.01)) as [number, number];\n    this.size = point.get(size);\n    this.borderSize = point.get(borderSize);\n    this.position = point.get(startPos, point.mul(this.borderSize, 0.5)) as [number, number];\n  }\n\n  public setPayload(pl: Payload): this {\n    this.payload = pl;\n    return this;\n  }\n\n  private hitTest(nextPos: Point): [1 | -1, 1 | -1] | null {\n    const [px, py] = nextPos;\n    const [zx, zy] = this.size;\n    const [bx, by] = this.borderSize;\n\n    const hitTop = py < 0;\n    const hitBottom = py + zy > by;\n    const hitLeft = px < 0;\n    const hitRight = px + zx > bx;\n\n    if (hitTop || hitBottom || hitLeft || hitRight) {\n      return [hitLeft || hitRight ? -1 : 1, hitTop || hitBottom ? -1 : 1];\n    }\n\n    return null;\n  }\n\n  public next(): void {\n    const [px, py] = this.position;\n    const [sx, sy] = this.speed;\n    const nextPos: Point = [px + sx, py + sy];\n    const bounce = this.hitTest(nextPos);\n    if (bounce) {\n      this.speed[0] = this.speed[0] * bounce[0];\n      this.speed[1] = this.speed[1] * bounce[1];\n    } else {\n      this.position[0] = nextPos[0];\n      this.position[1] = nextPos[1];\n    }\n    this.step += 1;\n  }\n\n  public rewind(steps: number): this {\n    for (let i = 0; i < steps; i++) {\n      this.next();\n    }\n    return this;\n  }\n\n  static randomDirection(speed: number): Point {\n    return point.rotate([speed, 0], Math.random() * TWO_PI);\n  }\n\n  static speedDirection(speed: number, rotInRad: number): Point {\n    return point.rotate([speed, 0], rotInRad);\n  }\n}\n","import { Canvas } from '@13h/core';\n\nexport const whiteNoise = (c: Canvas) => {\n  const data = c.context.getImageData(0, 0, c.width, c.height);\n  const max = c.width * c.height;\n  for (let i = 0; i < max; i++) {\n    const rnd = Math.round(Math.random() * 255);\n    data.data[i * 4] = rnd;\n    data.data[i * 4 + 1] = rnd;\n    data.data[i * 4 + 2] = rnd;\n    data.data[i * 4 + 3] = 255;\n  }\n  c.context.putImageData(data, 0, 0);\n};\n"],"names":["point","TWO_PI"],"mappings":"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"}
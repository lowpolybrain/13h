{"version":3,"file":"index.js","sources":["../src/makeColorTransparent.ts"],"sourcesContent":["import { Canvas } from '@13h/core';\n\ntype ColorArg = Uint8ClampedArray | [number, number, number];\n\n// TODO: Write in doc about alpha-premultiplication\nexport const setColorTransparency = function (canvas: Canvas, color: ColorArg, transparency1: number = 1) {\n  if (!color) {\n    return null;\n  }\n  const transparency = Math.floor(transparency1 * 255);\n\n  const [tr, tg, tb] = color;\n  const [width, height] = canvas.size;\n  const imageData: ImageData = canvas.context.getImageData(0, 0, width, height);\n\n  for (let i = 0; i < imageData.data.length; i += 4) {\n    const r = imageData.data[i];\n    const g = imageData.data[i + 1];\n    const b = imageData.data[i + 2];\n    if (tr === r && tg === g && tb === b) {\n      imageData.data[i + 3] = transparency;\n    }\n  }\n  canvas.context.putImageData(imageData, 0, 0);\n};\n\nexport const makeColorTransparent = function (canvas: Canvas, color: Uint8ClampedArray | [number, number, number]) {\n  setColorTransparency(canvas, color, 0);\n};\n"],"names":[],"mappings":";;;;AAIA;MACa,oBAAoB,GAAG,UAAU,MAAc,EAAE,KAAe,EAAE,gBAAwB,CAAC;IACtG,IAAI,CAAC,KAAK,EAAE;QACV,OAAO,IAAI,CAAC;KACb;IACD,MAAM,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,aAAa,GAAG,GAAG,CAAC,CAAC;IAErD,MAAM,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,GAAG,KAAK,CAAC;IAC3B,MAAM,CAAC,KAAK,EAAE,MAAM,CAAC,GAAG,MAAM,CAAC,IAAI,CAAC;IACpC,MAAM,SAAS,GAAc,MAAM,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,MAAM,CAAC,CAAC;IAE9E,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC,EAAE;QACjD,MAAM,CAAC,GAAG,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QAC5B,MAAM,CAAC,GAAG,SAAS,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;QAChC,MAAM,CAAC,GAAG,SAAS,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;QAChC,IAAI,EAAE,KAAK,CAAC,IAAI,EAAE,KAAK,CAAC,IAAI,EAAE,KAAK,CAAC,EAAE;YACpC,SAAS,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,YAAY,CAAC;SACtC;KACF;IACD,MAAM,CAAC,OAAO,CAAC,YAAY,CAAC,SAAS,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;AAC/C,EAAE;MAEW,oBAAoB,GAAG,UAAU,MAAc,EAAE,KAAmD;IAC/G,oBAAoB,CAAC,MAAM,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC;AACzC;;;;;"}